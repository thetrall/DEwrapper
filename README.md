# DEwrapper

Обертка для работы с ЦДО ИТМО (https://de.ifmo.ru).

Парсит веб-интерфейс, потому что API любит часто не отвечать.

## Установки

Добавьте в gemfile:

```ruby
gem 'DEwrapper'
```

И выполните:

    $ bundle

Или установите самостоятельно:

    $ gem install DEwrapper

## Использование

### Работа с пользователем и авторизация
Для того, чтобы работать с каким-либо классом, необходимо сначала авторизоваться:

```ruby
user = DEwrapper::User.new_with_login(login, password)
```

Если у вас есть токен, то можно его передать в конструктор. Токен – это кука JSESSION. 
Имеет форму вида `abcdefghijklmnopqrst.academicnt1` (последняя цифра может отличаться). 
Именно это и нужно передать в конструктор.
```ruby
user = DEwrapper::User.new(token)
```

Получение информации о пользователе (возвращает Hash):
```ruby
user.info
```

### Электронный журнал

Возвращает Hash с оценками на текущий учебный год. Можно вывести конкретный семестр, а можно за два сразу, для этого
номер семестра = 0

```ruby
user.marks.current 1 # 1 = номер семестра
```

Альтернативный способ:
```ruby
DEwrapper::Marks.new(user).current 1
```

Пример структуры:
```ruby
{:semesters=>
  {1=>
    [{:subject=>
       "Алгоритмы и структуры данных (Б1.Общепрофессиональный модуль.21-ФИТиП)",
      :rating=>80.5,
      :examination_type=>:exam,
      :examination_result=>"хорошо"},
     {:subject=>"Архитектура ЭВМ (Б1.Факультетский модуль.28-ФИТиП)",
      :rating=>64.0,
      :examination_type=>:credit,
      :examination_result=>"зачет"}
    ]
  }
}
```

## Что уже работает

* Авторизация
* Получение информации о пользователе
* Получение оценок за текущий год

## Что еще

Тесты есть, но их тестами сложно назвать. Добавьте файл .env.test.local, с двумя переменными DE_LOGIN и DE_PASSWORD.

Можете кидаться пулл-реквестами на https://github.com/thetrall/DEwrapper.

## Лицензия

Можете использовать код, но про меня не забывайте.
